<%# The "div"s here are not balanced within the file.
    That allows us to fill in and then end the current column & row,
    followed by starting and finishing another full row. %>
<% badge_hostname = (ENV['PUBLIC_HOSTNAME'] || 'localhost') %>
<%# TODO: Use badge_percentage_1 %>
<% content_for :insert_progress_bar do %>
  <div id="progress-mobile" class="progress">
    <div id="badge-progress"
         class="progress-bar progress-bar-success badge-progress"
         role="progressbar" aria-valuenow="<%= project.badge_percentage_0 %>"
         aria-valuemin="0" aria-valuemax="100">
      <%= project.badge_percentage_0 %>%
    </div>
  </div>
<% end %>
<% cache_if is_disabled, project do %>
<%= render(partial: 'form_early',
           locals:
             {
               project: project, is_disabled: is_disabled,
               badge_hostname: badge_hostname
             }) %>

<div class="row">
  <div class="col-md-12">
 <div>
  <%= bootstrap_form_for project, url: put_project_path(project, criteria_level: '1') do |f| %>
    <%= render 'shared/error_messages', object: f.object %>
    <%= f.hidden_field :lock_version %>

<%= render(partial: 'form_basics',
           locals:
             {
               project: project, is_disabled: is_disabled,
               badge_hostname: badge_hostname, f: f,
               criteria_level: '1'
             }) %>

          </li>

          <li class="list-group-item"><h3>Upgrades</h3>
            <%= render_status 'contribution_requirements', f, project, '1', is_disabled %>
            <%= render_status 'report_tracker', f, project, '1', is_disabled %>
 <% byebug %>
          </li>
          <li class="list-group-item"><h3>Structure</h3>
            <%= render_status 'dco', f, project, '1', is_disabled %>
            <%= render_status 'code_of_conduct', f, project, '1', is_disabled %>
            <%= render_status 'governance', f, project, '1', is_disabled %>
            <%= render_status 'roles_responsibilities', f, project, '1', is_disabled %>
          </li>
          <li class="list-group-item"><h3>Documentation</h3>
            <%= render_status 'documentation_roadmap', f, project, '1', is_disabled %>
            <%= render_status 'documentation_architecture', f, project, '1', is_disabled %>
            <%= render_status 'documentation_security', f, project, '1', is_disabled %>
            <%= render_status 'documentation_quick_start', f, project, '1', is_disabled %>
            <%= render_status 'documentation_current', f, project, '1', is_disabled %>
            <%= render_status 'documentation_achievements', f, project, '1', is_disabled %>
          </li>
          <li class="list-group-item"><h3>Accessibility and Internationalizatoin</h3>
            <%= render_status 'accessibility_best_practices', f, project, '1', is_disabled %>
            <%= render_status 'internationalization', f, project, '1', is_disabled %>
          </li>
          <li class="list-group-item"><h3>Continuity</h3>
            <%= render_status 'access_continuity', f, project, '1', is_disabled %>
            <%= render_status 'bus_factor', f, project, '1', is_disabled %>
          </li>
          <li class="list-group-item"><h3>Other</h3>
            <%= render_status 'sites_password_security', f, project, '1', is_disabled %>
          </li>
          </ul>

      <% unless is_disabled %>
        <div class="panel-footer text-center">
          By submitting this data about the project you agree to release it
          under at least the
          <a href="https://creativecommons.org/licenses/by/3.0/us"
          target="_blank">Creative Commons Attribution version 3.0 or later
          license (CC-BY-3.0+)</a>. This means that all are free to share
          and adapt the data, but they must give appropriate credit.
          You retain copyright (if any), and the project
          license is unaffected.<br><br>
          <%= f.button 'Save (and continue)', type: 'submit', name: 'continue',
              value: 'changecontrol', class:"btn btn-success btn-submit" %>
          <%= f.submit 'Submit (and exit)', class:"btn btn-success btn-submit" %>
        </div>
      <% end %>
     </div>
    </div>

    <div class="panel panel-primary">
      <div class="panel-heading close-by-default can-collapse" id="changecontrol">
        <% satisfaction_data = project.get_satisfaction_data('1','changecontrol') %>
        <h4 class="panel-title">
          <i class="glyphicon"></i>&nbsp;Change Control
          <span class="pull-right satisfaction">
            <span class="satisfaction-text"><%= satisfaction_data[:text] %></span>
            <span class="satisfaction-bullet" data-color="<%= satisfaction_data[:color] %>">&#9679;</span>
          </span>
        </h4>
      </div>
      <div class="panel-collapse collapse in remove-in">
        <ul class="list-group">
          <li class="list-group-item"><h3>Public version-controlled source repository</h3>

            <%= render_status 'repo_public', f, project, '0', is_disabled %>

            <%= render_status 'repo_track', f, project, '0', is_disabled %>

            <%= render_status 'repo_interim', f, project, '0', is_disabled %>

            <%= render_status 'repo_distributed', f, project, '0', is_disabled, true %>

          </li>

          <li class="list-group-item"><h3>Version numbering</h3>

            <%= render_status 'version_unique', f, project, '0', is_disabled %>

            <%= render_status 'version_semver', f, project, '0', is_disabled %>

            <%= render_status 'version_tags', f, project, '0', is_disabled, true %>

          </li>

          <li class="list-group-item"><h3>Release Notes</h3>

            <%= render_status 'release_notes', f, project, '0', is_disabled %>

            <%= render_status 'release_notes_vulns', f, project, '0', is_disabled, true %>
          </li>
        </ul>
        <% unless is_disabled %>
          <div class="panel-footer text-center">
            By submitting this data about the project you agree to release it
            under at least the
            <a href="https://creativecommons.org/licenses/by/3.0/us"
            target="_blank">Creative Commons Attribution version 3.0 or later
            license (CC-BY-3.0+)</a>. This means that all are free to share
            and adapt the data, but they must give appropriate credit.
            You retain copyright (if any), and the project
            license is unaffected.<br><br>
            <%= f.button 'Save (and continue)', type: 'submit', name: 'continue',
              value: 'reporting', class:"btn btn-success btn-submit" %>
            <%= f.submit 'Submit (and exit)', class:"btn btn-success btn-submit" %>
          </div>
        <% end %>
      </div>
    </div>

    <div class="panel panel-primary">
      <div class="panel-heading close-by-default can-collapse" id="reporting">
        <% satisfaction_data = project.get_satisfaction_data('0','reporting') %>
        <h4 class="panel-title">
          <i class="glyphicon"></i>&nbsp;Reporting
          <span class="pull-right satisfaction">
            <span class="satisfaction-text"><%= satisfaction_data[:text] %></span>
            <span class="satisfaction-bullet" data-color="<%= satisfaction_data[:color] %>">&#9679;</span>
          </span>
        </h4>
      </div>
      <div class="panel-collapse collapse in remove-in">
        <ul class="list-group">
          <li class="list-group-item"><h3>Bug reporting process</h3>

            <%= render_status 'report_process', f, project, '0', is_disabled %>

            <%= render_status 'report_tracker', f, project, '0', is_disabled %>

            <%= render_status 'report_responses', f, project, '0', is_disabled %>

            <%= render_status 'enhancement_responses', f, project, '0', is_disabled %>

            <%= render_status 'report_archive', f, project, '0', is_disabled, true %>

          </li>

          <li class="list-group-item"><h3>Vulnerability reporting process</h3>

            <%= render_status 'vulnerability_report_process',
                              f, project, '0', is_disabled %>

            <%= render_status 'vulnerability_report_private',
                              f, project, '0', is_disabled %>

            <%= render_status 'vulnerability_report_response',
                              f, project, '0', is_disabled, true %>
          </li>
        </ul>
        <% unless is_disabled %>
          <div class="panel-footer text-center">
            By submitting this data about the project you agree to release it
            under at least the
            <a href="https://creativecommons.org/licenses/by/3.0/us"
            target="_blank">Creative Commons Attribution version 3.0 or later
            license (CC-BY-3.0+)</a>. This means that all are free to share
            and adapt the data, but they must give appropriate credit.
            You retain copyright (if any), and the project
            license is unaffected.<br><br>
            <%= f.button 'Save (and continue)', type: 'submit', name: 'continue',
              value: 'quality', class:"btn btn-success btn-submit" %>
            <%= f.submit 'Submit (and exit)', class:"btn btn-success btn-submit" %>
          </div>
        <% end %>
      </div>
    </div>

    <div class="panel panel-primary">
      <div class="panel-heading close-by-default can-collapse" id="quality">
        <% satisfaction_data = project.get_satisfaction_data('0','quality') %>
        <h4 class="panel-title">
          <i class="glyphicon"></i>&nbsp;Quality
          <span class="pull-right satisfaction">
            <span class="satisfaction-text"><%= satisfaction_data[:text] %></span>
            <span class="satisfaction-bullet" data-color="<%= satisfaction_data[:color] %>">&#9679;</span>
          </span>
        </h4>
      </div>
      <div class="panel-collapse collapse in remove-in">
        <ul class="list-group">
          <li class="list-group-item"><h3>Working build system</h3>

            <%= render_status 'build', f, project, '0', is_disabled %>

            <%= render_status 'build_common_tools', f, project, '0', is_disabled %>

            <%= render_status 'build_floss_tools', f, project, '0', is_disabled, true %>

          </li>

          <li class="list-group-item"><h3>Automated test suite</h3>

            <%= render_status 'test', f, project, '0', is_disabled %>

            <%= render_status 'test_invocation', f, project, '0', is_disabled %>

            <%= render_status 'test_most', f, project, '0', is_disabled %>

            <%= render_status 'test_continuous_integration',
                              f, project, '0', is_disabled, true %>

          </li>

          <li class="list-group-item"><h3>New functionality testing</h3>

            <%= render_status 'test_policy', f, project, '0', is_disabled %>

            <%= render_status 'tests_are_added', f, project, '0', is_disabled %>

            <%= render_status 'tests_documented_added', f, project, '0', is_disabled, true %>

          </li>

          <li class="list-group-item"><h3>Warning flags</h3>

            <%= render_status 'warnings', f, project, '0', is_disabled %>

            <%= render_status 'warnings_fixed', f, project, '0', is_disabled %>

            <%= render_status 'warnings_strict', f, project, '0', is_disabled, true %>
          </li>
        </ul>
        <% unless is_disabled %>
          <div class="panel-footer text-center">
            By submitting this data about the project you agree to release it
            under at least the
            <a href="https://creativecommons.org/licenses/by/3.0/us"
            target="_blank">Creative Commons Attribution version 3.0 or later
            license (CC-BY-3.0+)</a>. This means that all are free to share
            and adapt the data, but they must give appropriate credit.
            You retain copyright (if any), and the project
            license is unaffected.<br><br>
            <%= f.button 'Save (and continue)', type: 'submit', name: 'continue',
              value: 'security', class:"btn btn-success btn-submit" %>
            <%= f.submit 'Submit (and exit)', class:"btn btn-success btn-submit" %>
          </div>
        <% end %>
      </div>
    </div>

    <div class="panel panel-primary">
      <div class="panel-heading close-by-default can-collapse" id="security">
        <% satisfaction_data = project.get_satisfaction_data('0','security') %>
        <h4 class="panel-title">
          <i class="glyphicon"></i>&nbsp;Security
          <span class="pull-right satisfaction">
            <span class="satisfaction-text"><%= satisfaction_data[:text] %></span>
            <span class="satisfaction-bullet" data-color="<%= satisfaction_data[:color] %>">&#9679;</span>
          </span>
        </h4>
      </div>
      <div class="panel-collapse collapse in remove-in">
        <ul class="list-group">
          <li class="list-group-item"><h3>Secure development knowledge</h3>

            <%= render_status 'know_secure_design', f, project, '0', is_disabled %>

            <%= render_status 'know_common_errors', f, project, '0', is_disabled, true %>

          </li>
          <li class="list-group-item"><h3>Good cryptographic practices</h3>

            <span class="criteria-desc">
            Note that some software does not need to use cryptographic mechanisms.
            </span>
            <% if (!is_disabled) %>
              <br><br>
              <button class="btn btn-default hidden-print" type="button" id='all_crypto_na'>
                Press here if the software produced by the project does not use cryptographic mechanisms
              </button>
              <br>
            <% end %>
            <%= render_status 'crypto_published', f, project, '0', is_disabled %>

            <%= render_status 'crypto_call', f, project, '0', is_disabled %>

            <%= render_status 'crypto_floss', f, project, '0', is_disabled %>

            <%= render_status 'crypto_keylength', f, project, '0', is_disabled %>

            <%= render_status 'crypto_working', f, project, '0', is_disabled %>

            <%= render_status 'crypto_weaknesses', f, project, '0', is_disabled %>

            <%= render_status 'crypto_pfs', f, project, '0', is_disabled %>

            <%= render_status 'crypto_password_storage', f, project, '0', is_disabled %>

            <%= render_status 'crypto_random', f, project, '0', is_disabled, true %>

          </li>
          <li class="list-group-item"><h3>Secured delivery against man-in-the-middle (MITM) attacks</h3>

            <%= render_status 'delivery_mitm', f, project, '0', is_disabled %>

            <%= render_status 'delivery_unsigned', f, project, '0', is_disabled, true %>

          </li>
          <li class="list-group-item"><h3>Publicly-known vulnerabilities fixed</h3>

            <%= render_status 'vulnerabilities_fixed_60_days',
                              f, project, '0', is_disabled %>

            <%= render_status 'vulnerabilities_critical_fixed',
                              f, project, '0', is_disabled, true %>

          </li>
          <li class="list-group-item"><h3>Other security</h3>

            <%= render_status 'no_leaked_credentials', f, project, '0', is_disabled, true %>

          </li>
        </ul>
        <% unless is_disabled %>
          <div class="panel-footer text-center">
            By submitting this data about the project you agree to release it
            under at least the
            <a href="https://creativecommons.org/licenses/by/3.0/us"
            target="_blank">Creative Commons Attribution version 3.0 or later
            license (CC-BY-3.0+)</a>. This means that all are free to share
            and adapt the data, but they must give appropriate credit.
            You retain copyright (if any), and the project
            license is unaffected.<br><br>
            <%= f.button 'Save (and continue)', type: 'submit', name: 'continue',
              value: 'analysis', class:"btn btn-success btn-submit" %>
            <%= f.submit 'Submit (and exit)', class:"btn btn-success btn-submit" %>
          </div>
        <% end %>
      </div>
    </div>

    <div class="panel panel-primary">
      <div class="panel-heading close-by-default can-collapse" id="analysis">
        <% satisfaction_data = project.get_satisfaction_data('0','analysis') %>
        <h4 class="panel-title">
          <i class="glyphicon"></i>&nbsp;Analysis
          <span class="pull-right satisfaction">
            <span class="satisfaction-text"><%= satisfaction_data[:text] %></span>
            <span class="satisfaction-bullet" data-color="<%= satisfaction_data[:color] %>">&#9679;</span>
          </span>
        </h4>
      </div>
      <div class="panel-collapse collapse in remove-in">
        <ul class="list-group">
          <li class="list-group-item"><h3>Static code analysis</h3>

            <%= render_status 'static_analysis', f, project, '0', is_disabled %>

            <%= render_status 'static_analysis_common_vulnerabilities',
                              f, project, '0', is_disabled %>

            <%= render_status 'static_analysis_fixed',
                              f, project, '0', is_disabled %>

            <%= render_status 'static_analysis_often', f, project, '0', is_disabled, true %>

          </li>
          <li class="list-group-item"><h3>Dynamic analysis</h3>

            <%= render_status 'dynamic_analysis', f, project, '0', is_disabled %>

            <%= render_status 'dynamic_analysis_unsafe', f, project, '0', is_disabled %>

            <%= render_status 'dynamic_analysis_enable_assertions',
                              f, project, '0', is_disabled %>

            <%= render_status 'dynamic_analysis_fixed',
                              f, project, '0', is_disabled, true %>

          </li>
        </ul>
        <% unless is_disabled %>
          <div class="panel-footer text-center">
            By submitting this data about the project you agree to release it
            under at least the
            <a href="https://creativecommons.org/licenses/by/3.0/us"
            target="_blank">Creative Commons Attribution version 3.0 or later
            license (CC-BY-3.0+)</a>. This means that all are free to share
            and adapt the data, but they must give appropriate credit.
            You retain copyright (if any), and the project
            license is unaffected.<br><br>
            <%= f.button 'Save (and continue)', type: 'submit', name: 'continue',
              value: 'future', class:"btn btn-success btn-submit" %>
            <%= f.submit 'Submit (and exit)', class:"btn btn-success btn-submit" %>
          </div>
        <% end %>
      </div>
    </div>

    <div class="panel panel-primary">
      <div class="panel-heading close-by-default can-collapse" id="future">
        <% satisfaction_data = project.get_satisfaction_data('0','future') %>
        <h4 class="panel-title">
          <i class="glyphicon"></i>&nbsp;Future
          <span class="pull-right satisfaction">
            <span class="satisfaction-text"><%= satisfaction_data[:text] %></span>
            <span class="satisfaction-bullet" data-color="<%= satisfaction_data[:color] %>">&#9679;</span>
          </span>
        </h4>
      </div>
      <div class="panel-collapse collapse in remove-in">
        <br>
        These are criteria we intend to add in the near future, but are
        <i>not</i> currently required for a badge.
        This grace period allows projects to update to changed criteria
        and retain their badge as best practices improve.
        <br>

        <%= render_status 'installation_common', f, project, '0', is_disabled %>

        <%= render_status 'build_reproducible', f, project, '0', is_disabled %>

        <%= render_status 'crypto_used_network', f, project, '0', is_disabled %>

        <%= render_status 'crypto_tls12', f, project, '0', is_disabled %>

        <%= render_status 'crypto_certificate_verification', f, project, '0', is_disabled %>

        <%= render_status 'crypto_verification_private', f, project, '0', is_disabled %>

        <%= render_status 'hardened_site', f, project, '0', is_disabled %>

        <%= render_status 'hardening', f, project, '0', is_disabled, true %>

      </div>
    </div>
  </div>
      <br>
      <div class="center">
      <% if is_disabled %>
        <% if project.show_entry_license? %>
          <!-- The user agreed to "3.0 or later", not just 3.0 -->
          This data is available under the
          <a href="https://creativecommons.org/licenses/by/3.0/us"
          target="_blank">Creative Commons Attribution version 3.0 or later
          license (CC-BY-3.0+)</a>. All are free to share
          and adapt the data, but must give appropriate credit.
          Please credit <%= project.user_name %> and
          the CII Best Practices badge contributors.<br><br>
        <% else %>
          <!-- This is older data and the user didn't indicate anything,
               so the "terms of use" of CII apply, which said that unless
               otherwise noted it's released under CC-BY-3.0 only. -->
          This data is available under the
          <a href="https://creativecommons.org/licenses/by/3.0/us"
          target="_blank">Creative Commons Attribution version 3.0
          license (CC-BY-3.0)</a> per the
          <a href="https://www.coreinfrastructure.org/" target="_blank">Core Infrastructure Initiative</a>
          <a href="https://www.linuxfoundation.org/terms" target="_blank">terms of use</a>.
          All are free to share
          and adapt the data, but must give appropriate credit.
          Please credit <%= project.user_name %> and
          the CII Best Practices badge contributors.<br><br>
        <% end %>
      <% else %>
        By submitting this data about the project you agree to release it
        under at least the
        <a href="https://creativecommons.org/licenses/by/3.0/us"
        target="_blank">Creative Commons Attribution version 3.0 or later
        license (CC-BY-3.0+)</a>. This means that all are free to share
        and adapt the data, but they must give appropriate credit.
        You retain copyright (if any), and the project
        license is unaffected.<br><br>
        <%= f.button 'Save (and continue)', type: 'submit', name: 'continue',
          value: 'Save', class:"btn btn-success btn-submit" %>
        <%= f.submit 'Submit (and exit)', class:"btn btn-success btn-submit" %>
      <% end %>
      </div>
    <% end %>
  </div>
</div>
</div>
<% end %>
